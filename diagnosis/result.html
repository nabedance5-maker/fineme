<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Âç∞Ë±°„Ç¢„ÉÉ„ÉóË®∫Êñ≠ - ÁµêÊûú</title>
  <link rel="stylesheet" href="../assets/styles/style.css">
  <link rel="stylesheet" href="../assets/styles/components.css">
  <style>
    .diag-container{max-width:900px;margin:36px auto;padding:20px}
    .diag-card{background:#fff;padding:18px;border-radius:12px;box-shadow:0 8px 30px rgba(2,6,23,0.06)}
    .result-title{font-size:22px;font-weight:800}
    .muted{color:#6b7280}
  .btn{display:inline-block;padding:8px 12px;border-radius:8px;background:#111;color:#fff;text-decoration:none}
  /* result article styling */
  .result-article{background:linear-gradient(180deg,#ffffff 0%,#fbfcfe 100%);padding:22px;border-radius:14px;border:1px solid rgba(2,6,23,0.04);box-shadow:0 18px 60px rgba(2,6,23,0.06);transition:transform .36s ease}
  .result-article:hover{transform:translateY(-6px)}
  .type-hero{display:block;margin:12px auto 18px auto;max-width:520px;width:100%;border-radius:12px;box-shadow:0 18px 40px rgba(2,6,23,0.14);object-fit:cover}
  .result-article h2{font-size:24px;margin-bottom:6px}
  .result-article h3{margin-top:14px;margin-bottom:6px}
  .result-label{color:#374151;margin-top:6px;font-size:14px}
  .badge-emoji{display:inline-block;width:44px;height:44px;border-radius:999px;background:linear-gradient(135deg,#fff 0%,#fffbeb 100%);box-shadow:0 6px 18px rgba(2,6,23,0.08);display:flex;align-items:center;justify-content:center;font-size:20px;margin-right:10px}
  .result-header{display:flex;align-items:center;gap:8px}
  .result-actions{display:flex;gap:8px;margin-top:12px}
  .btn-ghost{background:transparent;border:1px solid rgba(0,0,0,0.06);color:#111}
  .toast{position:fixed;right:20px;bottom:20px;background:#111;color:#fff;padding:8px 12px;border-radius:8px;opacity:0;transform:translateY(8px);transition:opacity .25s,transform .25s}
  .toast.show{opacity:1;transform:translateY(0)}
  @keyframes floatUp { from { transform: translateY(8px); opacity:0 } to { transform: translateY(0); opacity:1 } }
  /* block cards */
  .blocks-grid{display:grid;grid-template-columns:1fr;gap:12px;margin:8px 0 16px}
  .block{background:#f9fafb;border:1px solid #e5e7eb;border-radius:12px;padding:12px}
  .block-title{font-weight:700;margin-bottom:6px}

  /* highlight chips */
  .highlights{display:flex;flex-wrap:wrap;gap:8px;margin:8px 0 12px}
  .chip{background:#fff;border:1px solid #e5e7eb;border-radius:999px;padding:4px 10px;font-size:12px}

  /* horizontal slider */
  .result-slider{position:relative;margin-top:8px}
  .slider-controls{position:absolute;right:8px;top:-32px;display:flex;gap:8px}
  .slider-track{display:flex;gap:12px;overflow-x:auto;scroll-snap-type:x mandatory;padding-bottom:8px;-webkit-overflow-scrolling:touch}
  .slider-track::-webkit-scrollbar{height:8px}
  .slider-track::-webkit-scrollbar-thumb{background:#e5e7eb;border-radius:8px}
  .slide-card{flex:0 0 auto;width:200px;scroll-snap-align:start;background:#fff;border:1px solid #e5e7eb;border-radius:12px;box-shadow:0 4px 12px rgba(2,6,23,0.06);text-decoration:none;color:#111827}
  .slide-card:hover{transform:translateY(-2px);box-shadow:0 8px 18px rgba(2,6,23,0.08);transition:all .2s ease}
  .slide-image-wrap{display:flex;align-items:center;justify-content:center;height:120px;background:#f3f4f6;border-bottom:1px solid #e5e7eb;border-top-left-radius:12px;border-top-right-radius:12px}
  .slide-image-wrap img{max-width:72px;height:auto}
  .slide-label{padding:10px;font-weight:600}
  /* slide emoji badge */
  .slide-emoji{display:inline-flex;align-items:center;justify-content:center;width:44px;height:44px;border-radius:999px;background:linear-gradient(135deg,#fff 0%,#fef3c7 100%);box-shadow:0 6px 18px rgba(2,6,23,0.08);font-size:20px;margin:10px}
  /* info button & popover */
  .info-btn{background:transparent;border:1px solid #e5e7eb;color:#111;padding:6px 8px;border-radius:8px}
  .popover{position:absolute;right:8px;top:8px;z-index:30;background:#fff;border:1px solid #e5e7eb;border-radius:12px;box-shadow:0 12px 32px rgba(2,6,23,0.12);padding:12px;max-width:320px;display:none}
  .popover.show{display:block}
  .popover-title{font-weight:700;margin-bottom:6px}
  .popover p{color:#374151;font-size:14px;margin:6px 0}

  /* Âº∑Âà∂„Ç≥„É≥„Éà„É©„Çπ„ÉàÔºà„Åì„ÅÆ„Éö„Éº„Ç∏ÂÜÖÈôêÂÆöÔºâ */
  .result-article .btn{ background:#111 !important; color:#fff !important; border:none !important; box-shadow:0 8px 18px rgba(2,6,23,0.18) }
  .result-article .btn-ghost{ background:transparent !important; color:#111 !important; border:1px solid #111 !important }
  .diag-card .btn{ background:#111 !important; color:#fff !important; border:none !important }
  </style>
</head>
<body>
  <header id="site-header"></header>

  <main>
    <div class="diag-container">
      <div class="diag-card">
        <h1>Ë®∫Êñ≠ÁµêÊûú</h1>
        <div id="result-root">
          <div id="loading">ÁµêÊûú„ÇíË™≠„ÅøËæº„Åø‰∏≠‚Ä¶</div>
        </div>
  <p style="margin-top:12px;"><button id="retryBtn" class="btn">Ë®∫Êñ≠„Çí„ÇÑ„ÇäÁõ¥„Åô</button></p>
      </div>
    </div>
  </main>
  <footer id="site-footer"></footer>
  <script src="../scripts/main.js" type="module"></script>
  <script>
    (function(){
      const STORAGE_KEY = 'fineme:diagnosis:latest';
      const INTENT_TYPES_URL = '/data/intent-types.json';
      const root = document.getElementById('result-root');
      const loading = document.getElementById('loading');
      const retryBtn = document.getElementById('retryBtn');
      // Êñ∞6„Çø„Ç§„ÉóÔºà„Çπ„Éà„É¨„Éº„ÉàË°®Ë®òÔºâ
      const TYPE6_COPY = {
        t01: {
          name:'ÊÖéÈáç„ÉªÁ¥çÂæóÈáçË¶ñ„Çø„Ç§„Éó',
          state:'Â§â„Çè„Çä„Åü„ÅÑÊ∞óÊåÅ„Å°„ÅØ„ÅÇ„Çã„ÅÆ„Å´„ÄÅÂ§±Êïó„Åó„Åü„Åè„Å™„ÅÑÊÄù„ÅÑ„ÅåÂÖà„Å´Á´ã„Å°„ÄÅ‰∏ÄÊ≠©ÁõÆ„ÇíÊÖéÈáç„Å´ÈÅ∏„Åº„ÅÜ„Å®„Åó„Å¶„ÅÑ„ÇãÁä∂ÊÖã„Åß„Åô„ÄÇ',
          strength:'Ë°®Èù¢ÁöÑ„Å™Â§âÂåñ„Åß„ÅØÊ∫ÄË∂≥„Åõ„Åö„ÄÅÁêÜÁî±„Å®Ê†πÊã†„ÇíÂ§ßÂàá„Å´„Åß„Åç„Çã‰∫∫„Åß„Åô„ÄÇ',
          fit:[
            'ÁêÜÁî±„ÇíË®ÄË™ûÂåñ„Åó„ÄÅ„Éó„É≠„Çª„Çπ„ÅåË¶ã„Åà„ÇãÂ∞è„Åï„Å™Â§âÂåñ',
            'Êäº„ÅóÂ£≤„Çä„Åõ„Åö„ÄÅË≥™Âïè„Å´‰∏ÅÂØß„Å´Á≠î„Åà„Å¶„Åè„Çå„ÇãÈñ¢„Çè„ÇäÊñπ',
            'Ë©¶„Åó„Å¶„Åã„ÇâË™øÊï¥„Åß„Åç„ÇãÈÄ≤„ÇÅÊñπ'
          ],
          empathy:'„Äå„Å™„Çì„Å®„Å™„Åè„Äç„Åß„ÅØÂãï„Åã„Åö„ÄÅÁêÜÁî±„Å®Á¥çÂæó„ÅåÊèÉ„Å£„Åü„Å®„Åç„Å´Ê∫ÄË∂≥„Åß„Åç„Çã„Çø„Ç§„Éó„Åß„Åô„ÄÇ',
          logic:'Ë™¨Êòé„Åå‰∏ÅÂØß„Åß„ÄÅËÄÉ„ÅàÊñπ„ÇÑ„Éó„É≠„Çª„Çπ„ÇíË®ÄË™ûÂåñ„Åß„Åç„ÇãÂ∫óËàó„Å®Áõ∏ÊÄß„ÅåËâØ„ÅÑ„Å®Âà§Êñ≠„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ'
        },
        t02: {
          name:'ÂÆâÂøÉ„ÉªÂØÑ„ÇäÊ∑ª„ÅÑÈáçË¶ñ„Çø„Ç§„Éó',
          state:'ËààÂë≥„ÅØ„ÅÇ„Çã„Åë„Çå„Å©„Äå‰Ωï„ÅåÊ≠£Ëß£„Åã„Çè„Åã„Çâ„Å™„ÅÑ„Äç‰∏çÂÆâ„ÅåÂ§ß„Åç„Åè„ÄÅ‰º¥Ëµ∞„ÇÑË™¨Êòé„Åå„ÅÇ„Çã„Å®ÈÄ≤„Åø„ÇÑ„Åô„ÅÑÁä∂ÊÖã„Åß„Åô„ÄÇ',
          strength:'‰∫∫„ÅÆË©±„ÇíÁ¥†Áõ¥„Å´ËÅû„Åë„Å¶„ÄÅÁõ∏Ë´á„Åó„Å™„Åå„ÇâÊ±∫„ÇÅ„Çâ„Çå„Çã‰∫∫„Åß„Åô„ÄÇ',
          fit:[
            'ÂÖ®ÈÉ®‰ªª„Åõ„Çâ„Çå„ÇãÁí∞Â¢É„Åß„ÅÆÂ∞è„Åï„Å™ÂâçÈÄ≤',
            'ÊâãÈ†Ü„Çí‰∏Ä„Å§„Åö„Å§Á§∫„ÅôÈÄ≤„ÇÅÊñπ',
            '„Åì„Åæ„ÇÅ„Å™Á¢∫Ë™ç„Å®ÂÆâÂøÉ„ÅÆÊèê‰æõ'
          ],
          empathy:'Âº∑„ÅÑÂ£≤„Çä„Çà„Çä„ÄÅÂØÑ„ÇäÊ∑ª„ÅÑ„Å®ÂÆâÂøÉÊÑü„Åå„ÅÇ„Çã„Å®Ê∫ÄË∂≥„Åó„Åæ„Åô„ÄÇ',
          logic:'ÁÑ°ÁêÜ„Çí„Åï„Åõ„Å™„ÅÑÈÄ≤„ÇÅÊñπ„Åß„ÄÅÁõ∏Ë´á„Åó„Å™„Åå„ÇâÊ±∫„ÇÅ„Çâ„Çå„ÇãÂ∫óËàó„ÇíÂÑ™ÂÖà„Åó„Å¶Ë°®Á§∫„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ'
        },
        t03: {
          name:'ÂäπÁéá„ÉªÊúÄÁü≠ÈáçË¶ñ„Çø„Ç§„Éó',
          state:'‰ªä„ÅÆËá™ÂàÜ„Å´È£Ω„Åç„ÇÑÁÑ¶„Çä„Åå„ÅÇ„Çä„ÄÅÁµêÊûú„ÅåË¶ã„Åà„Çã„Å™„Çâ‰∏ÄÊ≠©„ÇíÊó©„ÅèË∏è„ÅøÂá∫„Åó„Åü„ÅÑÁä∂ÊÖã„Åß„Åô„ÄÇ',
          strength:'Ë°åÂãïÂäõ„Åå„ÅÇ„Çä„ÄÅË¶ÅÁÇπ„ÇíÊé¥„ÇÄ„ÅÆ„ÅåÂæóÊÑè„Åß„Åô„ÄÇ',
          fit:[
            'ÂÆüÁ∏æ„Å®ÁµêÊûú„ÅåÊòéÁ¢∫„Å™ÊèêÊ°à',
            'Áü≠„ÅÑË©¶Ë°å„Å®ÊîπÂñÑ„ÅÆ„Çµ„Ç§„ÇØ„É´',
            '„Ç¥„Éº„É´„Å®Ë®àÁîª„Åå„ÅØ„Å£„Åç„Çä„Åó„ÅüÈñ¢„Çè„ÇäÊñπ'
          ],
          empathy:'ÈÅ†Âõû„Çä„ÅåËã¶Êâã„Åß„ÄÅÁµêÂ±Ä„Å©„ÅÜ„Å™„Çã„Åã„ÅåÊòéÁ¢∫„Å†„Å®ÂÆâÂøÉ„Åß„Åç„Åæ„Åô„ÄÇ',
          logic:'Ë¶ÅÁÇπ„ÇíÊäº„Åï„Åà„ÄÅÂÆüÁ∏æ„Å®ÁµêÊûú„ÇíÁ§∫„Åõ„ÇãÂ∫óËàó„Çí‰∏ä‰Ωç„Å´Ë°®Á§∫„Åó„Åæ„Åô„ÄÇ'
        },
        t04: {
          name:'Â§âÂåñ„Éª„Ç¢„ÉÉ„Éó„Éá„Éº„ÉàÈáçË¶ñ„Çø„Ç§„Éó',
          state:'Êñ∞„Åó„ÅÑËá™ÂàÜ„Å´„ÉØ„ÇØ„ÉØ„ÇØ„Åó„Å¶„Åä„Çä„ÄÅÊåëÊà¶„ÇíÂâçÂêë„Åç„Å´Âèó„ÅëÂÖ•„Çå„Çâ„Çå„ÇãÁä∂ÊÖã„Åß„Åô„ÄÇ',
          strength:'Â§âÂåñ„ÇíÊ•Ω„Åó„ÇÅ„ÇãÊüîËªü„Åï„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ',
          fit:[
            'ÊèêÊ°àÂäõ„Åå„ÅÇ„ÇäËÉå‰∏≠„ÇíÊäº„Åó„Å¶„Åè„Çå„ÇãÈñ¢„Çè„ÇäÊñπ',
            'ÂÆâÂÖ®Á∂≤„ÇíÁî®ÊÑè„Åó„ÅüÁÑ°ÁêÜ„ÅÆ„Å™„ÅÑÊåëÊà¶',
            'Â§âÂåñ„ÅÆÊÑèÂõ≥„ÇíÂÖ±Êúâ„Åó„Å™„Åå„ÇâÈÄ≤„ÇÅ„Çã'
          ],
          empathy:'Â§öÂ∞ë„ÅÆÊåëÊà¶„Åß„ÇÇ„ÄÅÂ§â„Çè„Çå„Çã„Å™„Çâ‰∏ÄÊ≠©„ÇíÈÅ∏„Åπ„Çã„Çø„Ç§„Éó„Åß„Åô„ÄÇ',
          logic:'Â§âÂåñ„ÅÆÊèêÊ°àÂäõ„Åå„ÅÇ„Çä„ÄÅËÉå‰∏≠„ÇíÊäº„Åó„Å¶„Åè„Çå„ÇãÂ∫óËàó„ÇíÂÑ™ÂÖà„Åó„Åæ„Åô„ÄÇ'
        },
        t05: {
          name:'Áõ¥ÊÑü„Éª„Éï„Ç£„Éº„É™„É≥„Ç∞ÈáçË¶ñ„Çø„Ç§„Éó',
          state:'Èõ∞Âõ≤Ê∞ó„ÇÑ‰∏ñÁïåË¶≥„ÅÆÂêàËá¥„Åå‰Ωï„Çà„ÇäÂ§ß‰∫ã„Åß„ÄÅËÖë„Å´ËêΩ„Å°„ÇãÁõ∏Êâã„Å®„Å™„ÇâË∏è„ÅøÂá∫„Åõ„ÇãÁä∂ÊÖã„Åß„Åô„ÄÇ',
          strength:'Ëá™ÂàÜ„ÅÆÊÑüË¶ö„ÇíÂ§ßÂàá„Å´„Åó„ÄÅ„Åù„Çå„ÇíÁ∂ôÁ∂öÂäõ„Å´Â§â„Åà„Çâ„Çå„Çã‰∫∫„Åß„Åô„ÄÇ',
          fit:[
            '‰∏ñÁïåË¶≥„Å®„Çπ„Çø„Ç§„É´„ÅåÊòéÁ¢∫„Å™Áõ∏Êâã',
            '‰∫ã‰æã„Åß„Ç§„É°„Éº„Ç∏„Åß„Åç„ÇãÊèêÊ°à',
            '„Åæ„Åö„ÅØÂ∞è„Åï„ÅèË©¶„Åõ„Çã‰∏ÄÊ≠©'
          ],
          empathy:'‰∏ñÁïåË¶≥„ÇÑÁ©∫Ê∞óÊÑü„Å´Á¥çÂæó„Åß„Åç„Çã„Å®Ê∫ÄË∂≥„Åô„Çã„Çø„Ç§„Éó„Åß„Åô„ÄÇ',
          logic:'„Çπ„Çø„Ç§„É´„ÇÑÊÄùÊÉ≥„ÅåÊòéÁ¢∫„Åß„ÄÅÊÑüË¶ö„ÅåÂêà„ÅÜÂ∫óËàó„ÇíÂÑ™ÂÖà„Åó„Åæ„Åô„ÄÇ'
        },
        t06: {
          name:'‰º¥Ëµ∞„ÉªÂÖ±ÂêåÊ±∫ÂÆöÈáçË¶ñ„Çø„Ç§„Éó',
          state:'‰∏ÄÁ∑í„Å´ËÄÉ„Åà„Å™„Åå„ÇâÁ¥çÂæó„Åó„Å¶ÈÄ≤„Åø„Åü„ÅÑ„ÄÅ‰∏ªÂ∞éÊ®©„ÇíÂÖ±Êúâ„Åó„Åü„ÅÑÁä∂ÊÖã„Åß„Åô„ÄÇ',
          strength:'ÂØæË©±„ÇíÈÄö„Åò„Å¶ÊÑèÊÄùÊ±∫ÂÆö„Åß„Åç„Çã‰∫∫„Åß„Åô„ÄÇ',
          fit:[
            'ÈÅ∏ÊäûËÇ¢„ÇíÊèêÁ§∫„Åó„ÄÅÂÖ±Âêå„ÅßÊ±∫„ÇÅ„ÇãÈÄ≤„ÇÅÊñπ',
            'ÊåØ„ÇäËøî„Çä„Å®Ë™øÊï¥„ÇíÂâçÊèê„Å´„Åó„ÅüË®≠Ë®à',
            '„É°„É¢„ÇÑË®òÈå≤„ÇíÂÖ±Êúâ„Åó„Å™„Åå„ÇâÈÄ≤„ÇÅ„Çã'
          ],
          empathy:'‰∏ÄÁ∑í„Å´ËÄÉ„Åà„ÄÅÁ¥çÂæó„Åó„Å™„Åå„ÇâÈÄ≤„ÇÅ„Åü„ÅÑ„Çø„Ç§„Éó„Åß„Åô„ÄÇ',
          logic:'ÊèêÊ°à„Å®ÂØæË©±„ÅÆ„Éê„É©„É≥„Çπ„ÅåËâØ„Åè„ÄÅÂÖ±Âêå„ÅßÊ±∫„ÇÅ„Å¶„ÅÑ„Åë„ÇãÂ∫óËàó„Çí‰∏ä‰Ωç„Å´Ë°®Á§∫„Åó„Åæ„Åô„ÄÇ'
        }
      };

  function renderNotFound(){
    const wrap = document.createElement('div');
    const msg = document.createElement('p'); msg.textContent = 'Ë®∫Êñ≠ÁµêÊûú„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„ÄÇÊúÄÂàù„Åã„Çâ„ÇÑ„ÇäÁõ¥„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ';
    const a = document.createElement('a'); a.href = '/diagnosis/index.html'; a.className = 'btn'; a.textContent = 'Ë®∫Êñ≠„Çí„ÇÑ„ÇäÁõ¥„Åô';
    wrap.appendChild(msg); wrap.appendChild(a);
    root.innerHTML = ''; root.appendChild(wrap);
  }

      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw){ renderNotFound(); }
      else{
        try{
          const obj = JSON.parse(raw);
          const step2 = obj.step2 || {};
          const cls = step2.classification || { type_id:'t01', type_name:'ÊÖéÈáç„ÉªÁ¥çÂæóÈáçË¶ñ„Çø„Ç§„Éó' };
          const copy = TYPE6_COPY[cls.type_id] || TYPE6_COPY.t01;
          // typesDataÔºàÊóßÁ¨¨2ÈöéÂ±§Ôºâ„ÅØ‰ªªÊÑèÁîªÂÉè„Å™„Å©„Å´‰Ωø„ÅÜ„ÄÇ„Å™„Åè„Å¶„ÇÇÈÄ≤Ë°å„ÄÇ
          fetch(INTENT_TYPES_URL).then(r=>r.json()).then(typesData=>{
            const entry = typesData[obj?.intent?.type_id || ''] || {};
            // Êñ∞MVPÊßãÊàê„ÅßÊèèÁîª
            root.innerHTML = '';

            const article = document.createElement('article'); article.className = 'result-article'; article.style.marginTop = '12px'; article.style.lineHeight = '1.7';

            // ‚ë† „Çø„Ç§„Éà„É´Ôºö‰ªä„ÅÆ„ÅÇ„Å™„Åü„ÅÆÁä∂ÊÖãÔºàÂà§ÂÆöÊÑü„ÇíÈÅø„Åë„ÇãÔºâ
            const headerWrap = document.createElement('div'); headerWrap.className = 'result-header';
            const badge = document.createElement('div'); badge.className = 'badge-emoji'; badge.textContent = 'üí´'; headerWrap.appendChild(badge);
            const titleWrap = document.createElement('div');
            const title = document.createElement('h2'); title.style.fontSize = '22px'; title.style.margin = '0';
            title.textContent = '‰ªä„ÅÆ„ÅÇ„Å™„Åü„ÅÆÁä∂ÊÖã';
            titleWrap.appendChild(title);
            const label = document.createElement('div'); label.className='result-label';
            label.textContent = '„ÄåÁèæÊôÇÁÇπ„Åß„ÅØ„Äç„Åì„ÅÜË¶ã„Åà„Å¶„ÅÑ„Åæ„Åô„ÄÇÁÑ¶„Çâ„Å™„Åè„Å¶Â§ß‰∏àÂ§´„ÄÇ';
            titleWrap.appendChild(label);
            headerWrap.appendChild(titleWrap); article.appendChild(headerWrap);

            if(entry.image){ const heroWrap = document.createElement('div'); heroWrap.style.textAlign='center'; const hero = document.createElement('img'); hero.className = 'type-hero'; hero.src = entry.image; hero.alt = entry.name||''; hero.onerror = ()=>{ hero.style.display='none'; }; hero.style.animation='floatUp .6s ease both'; heroWrap.appendChild(hero); article.appendChild(heroWrap); }

            // ‚ë° Áä∂ÊÖã„ÅÆË®ÄË™ûÂåñÔºà„Ç≥„Ç¢„Ç≥„Éî„ÉºÔºâ
            const stateP = document.createElement('p'); stateP.style.margin='8px 0 12px 0'; stateP.textContent = copy.state || copy.empathy || '';
            article.appendChild(stateP);

            // ‚ë¢ Âº∑„Åø„ÅÆÂÜçÂÆöÁæ©ÔºàËá™Â∑±Âê¶ÂÆö„ÇíÈò≤„ÅêÔºâ
            const strongH = document.createElement('h3'); strongH.textContent = '„Åì„Çå„ÅØ„ÄåÊÇ™„ÅÑ„Äç„Åß„ÅØ„Å™„Åè„ÄÅ„ÅÇ„Å™„Åü„ÅÆÂº∑„Åø„Åß„Åô'; article.appendChild(strongH);
            const strongP = document.createElement('p'); strongP.textContent = copy.strength || '„ÅÇ„Å™„Åü„ÅØËá™ÂàÜ„Å´Âêà„ÅÜÈÄ≤„ÇÅÊñπ„ÇíÈÅ∏„Åπ„Çã‰∫∫„Åß„Åô„ÄÇ'; article.appendChild(strongP);

            // ‚ë¢-2 Âº∑„Åø„Éè„Ç§„É©„Ç§„ÉàÔºà„ÉÅ„ÉÉ„ÉóÂåñÔºâ
            (function(){
              const highlightsWrap = document.createElement('div'); highlightsWrap.className='highlights';
              try{
                const text = (copy.strength || '').toString();
                const parts = text.split(/[„ÄÅ„ÄÇ„Éª\n]/).map(s=> s.trim()).filter(s=> s.length>0 && s.length<=30);
                const uniq = [];
                for(const p of parts){ if(!uniq.includes(p)) uniq.push(p); }
                (uniq.slice(0,3)).forEach(h=>{ const span = document.createElement('span'); span.className='chip'; span.textContent=h; highlightsWrap.appendChild(span); });
              }catch{}
              if(!highlightsWrap.children.length){ const span = document.createElement('span'); span.className='muted'; span.textContent='Ë¶ÅÁÇπ„ÇíÊäΩÂá∫„Åó„Å¶„ÅÑ„Åæ„Åô'; highlightsWrap.appendChild(span); }
              article.appendChild(highlightsWrap);
            })();

            // ‚ë£ „Åì„ÅÆË¶ãÁ´ã„Å¶„Å´„Å™„Å£„ÅüÁêÜÁî±ÔºàSTEP2„ÅÆÁ≠î„ÅàÂêà„Çè„ÅõÔºâ‚Üí „Éñ„É≠„ÉÉ„ÇØÔºãÊ®™„Çπ„É©„Ç§„ÉÄ„Éº
            (function(){
              const whyBlock = document.createElement('div'); whyBlock.className='block';
              const whyTitle = document.createElement('div'); whyTitle.className='block-title'; whyTitle.textContent='„Åì„ÅÆË¶ãÁ´ã„Å¶„Å´„Å™„Å£„ÅüÁêÜÁî±'; whyBlock.appendChild(whyTitle);
              const items = [];
              try{
                const stored = JSON.parse(localStorage.getItem('fineme:diagnosis:latest')||'{}');
                const axes = stored?.step2?.scores?.axes || {};
                const topAxes = Object.entries(axes).filter(([k,v])=> typeof v==='number').sort((a,b)=> (b[1]||0) - (a[1]||0)).slice(0,4);
                topAxes.forEach(([code])=>{
                  const map = {
                    motivation:['Â§â„Çè„Çä„Åü„ÅÑÁêÜÁî±„ÅåÊòéÁ¢∫ÔºàÊ∑±„Åï„Åå„ÅÇ„ÇãÔºâ','üéØ'],
                    support:['„Çµ„Éù„Éº„Éà„ÇíÂøÖË¶Å„Å®„Åô„ÇãÂ∫¶Âêà„ÅÑ„ÅåÈ´ò„ÅÑ','ü§ù'],
                    change:['Ê±Ç„ÇÅ„ÇãÂ§âÂåñ„ÅÆÂº∑„Åï„ÅåÈ´ò„ÅÑ','üîÑ'],
                    control:['‰∏ªÂ∞éÊ®©„ÇíËá™ÂàÜ„ÅßÊåÅ„Å°„Åü„ÅÑÔºà„Åæ„Åü„ÅØÂÖ±Âêå„ÅßÔºâ','üß†'],
                  };
                  const pair = map[code];
                  items.push({ label: (pair? pair[0]: ('ÈÅ∏„Å≥ÊñπËª∏('+code+')„ÇíÈáçË¶ñ„Åô„Çã')), emoji: (pair? pair[1]: 'üß≠') });
                });
                if(axes.value){ items.push({ label:'‰æ°ÂÄ§Ë¶≥„ÅØ„Äå'+ String(axes.value) +'„Äç„ÅåËøë„ÅÑ„Å®ÊÑü„Åò„Å¶„ÅÑ„Åæ„Åô', emoji:'üíé' }); }
              }catch{}
              if(!items.length){ items.push({ label:'„ÅÇ„Å™„Åü„ÅÆÈÅ∏Êäû„Å´Âü∫„Å•„ÅÑ„Å¶Â∞é„Åã„Çå„ÅüÁµêÊûú„Åß„Åô', emoji:'üß≠' }); }

              const slider = document.createElement('div'); slider.className='result-slider';
              const controls = document.createElement('div'); controls.className='slider-controls';
              const btnPrev = document.createElement('button'); btnPrev.className='btn btn-ghost'; btnPrev.setAttribute('aria-label','Ââç„Å∏'); btnPrev.textContent='‚Äπ';
              const btnNext = document.createElement('button'); btnNext.className='btn btn-ghost'; btnNext.setAttribute('aria-label','Ê¨°„Å∏'); btnNext.textContent='‚Ä∫';
              controls.appendChild(btnPrev); controls.appendChild(btnNext); slider.appendChild(controls);
              const track = document.createElement('div'); track.className='slider-track';
              items.forEach(it=>{
                const card = document.createElement('div'); card.className='slide-card';
                const emoji = document.createElement('div'); emoji.className='slide-emoji'; emoji.textContent = it.emoji || '‚ú®'; card.appendChild(emoji);
                const lab = document.createElement('div'); lab.className='slide-label'; lab.textContent=it.label; card.appendChild(lab);
                track.appendChild(card);
              });
              slider.appendChild(track);
              whyBlock.appendChild(slider);

              function onArrow(dir){ try{ const delta = dir==='next' ? Math.floor(track.clientWidth*0.8) : -Math.floor(track.clientWidth*0.8); track.scrollBy({ left: delta, behavior:'smooth' }); }catch{} }
              btnPrev.addEventListener('click', ()=> onArrow('prev'));
              btnNext.addEventListener('click', ()=> onArrow('next'));

              article.appendChild(whyBlock);
            })();

            // ‚ë§ ‰ªä„ÅÆÊÆµÈöé„ÅßÂêë„ÅÑ„Å¶„ÅÑ„ÇãÂ§âÂåñ ‚Üí „Éñ„É≠„ÉÉ„ÇØÔºãÊ®™„Çπ„É©„Ç§„ÉÄ„Éº
            (function(){
              const fitBlock = document.createElement('div'); fitBlock.className='block';
              const fitTitle = document.createElement('div'); fitTitle.className='block-title'; fitTitle.textContent='‰ªä„ÅÆÊÆµÈöé„ÅßÂêë„ÅÑ„Å¶„ÅÑ„ÇãÂ§âÂåñ'; fitBlock.appendChild(fitTitle);
              const rawItems = (copy.fit||[]).slice(0,6);
              if(!rawItems.length){ rawItems.push(copy.logic || '„ÅÇ„Å™„Åü„Å´Âêà„ÅÜÈÄ≤„ÇÅÊñπ„ÇíÂÑ™ÂÖà„Åó„Å¶Ë°®Á§∫„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ'); }
              const items = rawItems.map(t=>{
                const s = String(t);
                let emoji = '‚ú®';
                if(/Ë©¶|Â∞è„Åï|„ÉÜ„Çπ„Éà/.test(s)) emoji = 'üß™';
                else if(/Áõ∏Ë´á|‰º¥Ëµ∞|ÂØÑ„ÇäÊ∑ª|Á¢∫Ë™ç/.test(s)) emoji = 'ü§ù';
                else if(/Â§âÂåñ|„Ç¢„ÉÉ„Éó„Éá„Éº„Éà|ÊåëÊà¶/.test(s)) emoji = 'üîÑ';
                else if(/Ë®àÁîª|„Ç¥„Éº„É´|ÊâãÈ†Ü/.test(s)) emoji = 'üó∫Ô∏è';
                else if(/ÂÆüÁ∏æ|ÁµêÊûú|‰∏ä‰Ωç/.test(s)) emoji = 'üìà';
                return { label: s, emoji };
              });

              const slider = document.createElement('div'); slider.className='result-slider';
              const controls = document.createElement('div'); controls.className='slider-controls';
              const btnPrev = document.createElement('button'); btnPrev.className='btn btn-ghost'; btnPrev.setAttribute('aria-label','Ââç„Å∏'); btnPrev.textContent='‚Äπ';
              const btnNext = document.createElement('button'); btnNext.className='btn btn-ghost'; btnNext.setAttribute('aria-label','Ê¨°„Å∏'); btnNext.textContent='‚Ä∫';
              controls.appendChild(btnPrev); controls.appendChild(btnNext); slider.appendChild(controls);
              const track = document.createElement('div'); track.className='slider-track';
              items.forEach(it=>{
                const card = document.createElement('div'); card.className='slide-card';
                const emoji = document.createElement('div'); emoji.className='slide-emoji'; emoji.textContent = it.emoji || '‚ú®'; card.appendChild(emoji);
                const lab = document.createElement('div'); lab.className='slide-label'; lab.textContent=it.label; card.appendChild(lab);
                track.appendChild(card);
              });
              slider.appendChild(track);
              fitBlock.appendChild(slider);

              function onArrow(dir){ try{ const delta = dir==='next' ? Math.floor(track.clientWidth*0.8) : -Math.floor(track.clientWidth*0.8); track.scrollBy({ left: delta, behavior:'smooth' }); }catch{} }
              btnPrev.addEventListener('click', ()=> onArrow('prev'));
              btnNext.addEventListener('click', ()=> onArrow('next'));

              article.appendChild(fitBlock);
            })();

            // ‚ë• Ê¨°„ÅÆ‰∏ÄÊâãÔºàÊúÄÂ§ß2„Å§Ôºâ
            const nextActions = document.createElement('div'); nextActions.className='result-actions';
            const goSearch = document.createElement('a'); goSearch.href='/pages/search.html'; goSearch.className='btn'; goSearch.textContent='‰ªä„ÅÆËá™ÂàÜ„Å´Âêà„ÅÜÈÅ∏ÊäûËÇ¢„ÇíË¶ã„Çã'; nextActions.appendChild(goSearch);
            const goMypage = document.createElement('a'); goMypage.href='/pages/mypage/diagnosis.html'; goMypage.className='btn'; goMypage.textContent='Â∞ë„ÅóËÄÉ„Åà„Çã„Åü„ÇÅ„Å´‰øùÂ≠ò„Åô„Çã'; nextActions.appendChild(goMypage);
            article.appendChild(nextActions);

            // ‚ë•-2 ÊèêÊ°à„Ç´„Éº„Éâ„Çπ„É©„Ç§„ÉÄ„ÉºÔºàÊ®™„Çπ„ÇØ„É≠„Éº„É´Ôºâ‚Üí ÁµµÊñáÂ≠óÂåñÔºÜ„Çø„Ç§„Éó/Ëª∏„Åß‰∏¶„Å≥Êõø„Åà
            (function(){
              function baseSuggestions(){
                return [
                  { label: '„Éò„Ç¢„Ç´„ÉÉ„Éà/„Ç´„É©„Éº', emoji: 'üíá‚Äç‚ôÄÔ∏è', href: '/pages/search.html?keyword=„Éò„Ç¢' },
                  { label: '„É°„Ç§„ÇØÁõ∏Ë´á', emoji: 'üíÑ', href: '/pages/search.html?keyword=„É°„Ç§„ÇØ' },
                  { label: '„Éï„Ç°„ÉÉ„Ç∑„Éß„É≥Áõ∏Ë´á', emoji: 'üëó', href: '/pages/search.html?keyword=„Éï„Ç°„ÉÉ„Ç∑„Éß„É≥' },
                  { label: 'ÂÜôÁúüÊíÆÂΩ±', emoji: 'üì∏', href: '/pages/search.html?keyword=ÂÜôÁúü' },
                  { label: '„Éú„Éá„Ç£„É°„Ç§„ÇØ', emoji: 'üèãÔ∏è', href: '/pages/search.html?keyword=„Ç∏„É†' },
                  { label: 'Â©öÊ¥ª„Çµ„Éù„Éº„Éà', emoji: 'üíç', href: '/pages/search.html?keyword=Â©öÊ¥ª' },
                ];
              }

              function scoreSuggestions(typeId, axes){
                const list = baseSuggestions();
                const score = Object.fromEntries(list.map(s=> [s.label, 0]));
                // „Çø„Ç§„ÉóÂà•„ÅÆÂàùÊúüÈáç„Åø‰ªò„Åë
                const byType = {
                  t01: ['„É°„Ç§„ÇØÁõ∏Ë´á','„Éò„Ç¢„Ç´„ÉÉ„Éà/„Ç´„É©„Éº','„Éï„Ç°„ÉÉ„Ç∑„Éß„É≥Áõ∏Ë´á','ÂÜôÁúüÊíÆÂΩ±','„Éú„Éá„Ç£„É°„Ç§„ÇØ','Â©öÊ¥ª„Çµ„Éù„Éº„Éà'], // ÊÖéÈáç„ÉªÁ¥çÂæó
                  t02: ['„É°„Ç§„ÇØÁõ∏Ë´á','„Éï„Ç°„ÉÉ„Ç∑„Éß„É≥Áõ∏Ë´á','„Éò„Ç¢„Ç´„ÉÉ„Éà/„Ç´„É©„Éº','ÂÜôÁúüÊíÆÂΩ±','Â©öÊ¥ª„Çµ„Éù„Éº„Éà','„Éú„Éá„Ç£„É°„Ç§„ÇØ'], // ÂØÑ„ÇäÊ∑ª„ÅÑ
                  t03: ['ÂÜôÁúüÊíÆÂΩ±','„Éú„Éá„Ç£„É°„Ç§„ÇØ','„Éò„Ç¢„Ç´„ÉÉ„Éà/„Ç´„É©„Éº','„É°„Ç§„ÇØÁõ∏Ë´á','„Éï„Ç°„ÉÉ„Ç∑„Éß„É≥Áõ∏Ë´á','Â©öÊ¥ª„Çµ„Éù„Éº„Éà'], // ÊúÄÁü≠
                  t04: ['„Éï„Ç°„ÉÉ„Ç∑„Éß„É≥Áõ∏Ë´á','„Éò„Ç¢„Ç´„ÉÉ„Éà/„Ç´„É©„Éº','ÂÜôÁúüÊíÆÂΩ±','„É°„Ç§„ÇØÁõ∏Ë´á','„Éú„Éá„Ç£„É°„Ç§„ÇØ','Â©öÊ¥ª„Çµ„Éù„Éº„Éà'], // Â§âÂåñ
                  t05: ['ÂÜôÁúüÊíÆÂΩ±','„Éï„Ç°„ÉÉ„Ç∑„Éß„É≥Áõ∏Ë´á','„É°„Ç§„ÇØÁõ∏Ë´á','„Éò„Ç¢„Ç´„ÉÉ„Éà/„Ç´„É©„Éº','Â©öÊ¥ª„Çµ„Éù„Éº„Éà','„Éú„Éá„Ç£„É°„Ç§„ÇØ'], // Áõ¥ÊÑü/‰∏ñÁïåË¶≥
                  t06: ['„É°„Ç§„ÇØÁõ∏Ë´á','„Éï„Ç°„ÉÉ„Ç∑„Éß„É≥Áõ∏Ë´á','ÂÜôÁúüÊíÆÂΩ±','„Éò„Ç¢„Ç´„ÉÉ„Éà/„Ç´„É©„Éº','Â©öÊ¥ª„Çµ„Éù„Éº„Éà','„Éú„Éá„Ç£„É°„Ç§„ÇØ'], // ‰º¥Ëµ∞
                };
                (byType[typeId]||list.map(s=> s.label)).forEach((lab, i)=>{ score[lab] += (list.length - i); });

                // Ëª∏„Çπ„Ç≥„Ç¢„Å´„Çà„ÇãÂæÆË™øÊï¥
                try{
                  const ax = axes || {};
                  if(Number(ax.support) > 0){ score['„É°„Ç§„ÇØÁõ∏Ë´á'] += 3; score['„Éï„Ç°„ÉÉ„Ç∑„Éß„É≥Áõ∏Ë´á'] += 2; }
                  if(Number(ax.change) > 0){ score['ÂÜôÁúüÊíÆÂΩ±'] += 3; score['„Éú„Éá„Ç£„É°„Ç§„ÇØ'] += 2; }
                  if(Number(ax.control) > 0){ score['„Éï„Ç°„ÉÉ„Ç∑„Éß„É≥Áõ∏Ë´á'] += 2; score['„Éò„Ç¢„Ç´„ÉÉ„Éà/„Ç´„É©„Éº'] += 2; }
                  if(Number(ax.motivation) > 0){ score['„Éò„Ç¢„Ç´„ÉÉ„Éà/„Ç´„É©„Éº'] += 2; }
                }catch{}

                return list.sort((a,b)=> (score[b.label]||0) - (score[a.label]||0));
              }

              // ÂÖ•ÂäõÔºà„Çø„Ç§„ÉóID/Ëª∏Ôºâ
              let typeId = 't01'; let axes = {};
              try{
                const stored = JSON.parse(localStorage.getItem('fineme:diagnosis:latest')||'{}');
                typeId = (stored?.step2?.classification?.type_id) || typeId;
                axes = stored?.step2?.scores?.axes || {};
              }catch{}

              let suggestions = scoreSuggestions(typeId, axes);
              // ÂêÑ„É™„É≥„ÇØ„Å´„Çø„Ç§„ÉóÂêç„Çí‰ªò‰∏é„Åó„Å¶Ê§úÁ¥¢Á≤æÂ∫¶„ÇíÂêë‰∏ä
              const typeName = copy?.name || '';
              suggestions = suggestions.map(s=> ({ ...s, href: `${s.href}%20${encodeURIComponent(typeName)}` }));

              const slider = document.createElement('div'); slider.className='result-slider';
              const controls = document.createElement('div'); controls.className='slider-controls';
              const btnPrev = document.createElement('button'); btnPrev.className='btn btn-ghost'; btnPrev.setAttribute('aria-label','Ââç„Å∏'); btnPrev.textContent='‚Äπ';
              const btnNext = document.createElement('button'); btnNext.className='btn btn-ghost'; btnNext.setAttribute('aria-label','Ê¨°„Å∏'); btnNext.textContent='‚Ä∫';
              const btnInfo = document.createElement('button'); btnInfo.className='info-btn'; btnInfo.setAttribute('aria-label','‰∏¶„Å≥„ÅÆÁêÜÁî±'); btnInfo.textContent='‰∏¶„Å≥„ÅÆÁêÜÁî±';
              controls.appendChild(btnPrev); controls.appendChild(btnNext); controls.appendChild(btnInfo); slider.appendChild(controls);

              const track = document.createElement('div'); track.className='slider-track';
              suggestions.forEach(s=>{
                const a = document.createElement('a'); a.className='slide-card'; a.href=s.href;
                a.addEventListener('click', ()=>{
                  try{ window.dispatchEvent(new CustomEvent('fineme:analytics', { detail: { event:'result_slide_click', label: s.label, type: copy.name } })); }catch{}
                });
                const emoji = document.createElement('div'); emoji.className='slide-emoji'; emoji.textContent = s.emoji || '‚ú®'; a.appendChild(emoji);
                const lab = document.createElement('div'); lab.className='slide-label'; lab.textContent=s.label; a.appendChild(lab);
                track.appendChild(a);
              });
              slider.appendChild(track);
              // „Éù„ÉÉ„Éó„Ç™„Éº„Éê„ÉºÂÜÖÂÆπ
              const pop = document.createElement('div'); pop.className='popover';
              const popTitle = document.createElement('div'); popTitle.className='popover-title'; popTitle.textContent='„Åì„ÅÆ‰∏¶„Å≥„Å´„Å™„Å£„Å¶„ÅÑ„ÇãÁêÜÁî±'; pop.appendChild(popTitle);
              const pType = document.createElement('p'); pType.textContent = `„Çø„Ç§„ÉóÔºö${typeName}`; pop.appendChild(pType);
              try{
                const reasons = [];
                const ax = axes || {};
                const pairs = [
                  ['support', ax.support, 'ÂØÑ„ÇäÊ∑ª„ÅÑ/Áõ∏Ë´á„ÅåÊ¨≤„Åó„ÅÑÂÇæÂêë'],
                  ['change', ax.change, 'Â§âÂåñ„ÇíÂº∑„ÅèÊ±Ç„ÇÅ„ÇãÂÇæÂêë'],
                  ['control', ax.control, '‰∏ªÂ∞éÊ®©„ÇíÊåÅ„Å°„Åü„ÅÑ/ÂÖ±ÂêåÊ±∫ÂÆö„ÅÆÂÇæÂêë'],
                  ['motivation', ax.motivation, 'Â§â„Çè„Çä„Åü„ÅÑÁêÜÁî±„ÅåÊòéÁ¢∫„Å™ÂÇæÂêë']
                ];
                pairs.sort((a,b)=> (Number(b[1])||0) - (Number(a[1])||0)).slice(0,2).forEach(([,val,desc])=>{ if(Number(val)>0){ reasons.push(desc); } });
                const pAx = document.createElement('p'); pAx.textContent = reasons.length? `ÈáçË¶ñ„Åó„ÅüËª∏Ôºö${reasons.join('„ÄÅ')}` : 'ÈáçË¶ñ„Åó„ÅüËª∏ÔºöÂõûÁ≠î„Å´Âü∫„Å•„ÅèÁ∑èÂêàË©ï‰æ°'; pop.appendChild(pAx);
              }catch{}
              const pLead = document.createElement('p'); pLead.textContent = '‰∏ä„Åª„Å©‰ªä„ÅÆ„ÅÇ„Å™„Åü„Å´Âèñ„ÇäÁµÑ„Åø„ÇÑ„Åô„ÅÑÈÅ∏ÊäûËÇ¢„Åß„Åô„ÄÇÂøÖË¶Å„Å´Âøú„Åò„Å¶‰∏¶„Å≥„ÅØË™øÊï¥„Åï„Çå„Åæ„Åô„ÄÇ'; pop.appendChild(pLead);
              slider.appendChild(pop);
              // „Éù„ÉÉ„Éó„Ç™„Éº„Éê„ÉºÈñãÈñâ
              btnInfo.addEventListener('click', ()=>{ pop.classList.toggle('show'); });
              document.addEventListener('keydown', (e)=>{ if(e.key==='Escape'){ pop.classList.remove('show'); } });
              document.addEventListener('click', (e)=>{ if(!pop.contains(e.target) && e.target!==btnInfo){ pop.classList.remove('show'); } });
              article.appendChild(slider);

              function onArrow(dir){ try{ const delta = dir==='next' ? Math.floor(track.clientWidth*0.8) : -Math.floor(track.clientWidth*0.8); track.scrollBy({ left: delta, behavior:'smooth' }); }catch{} }
              btnPrev.addEventListener('click', ()=> onArrow('prev'));
              btnNext.addEventListener('click', ()=> onArrow('next'));
            })();

            // ‚ë¶ ÊÄ•„Åå„Å™„Åè„Å¶„ÅÑ„ÅÑÁêÜÁî±ÔºàÊàêÈï∑ÂâçÊèêÔºâ
            const gentle = document.createElement('p'); gentle.className='muted'; gentle.style.marginTop='8px'; gentle.textContent = '„Åì„Çå„ÅØ„Äå‰ªä„ÅÆ„ÅÇ„Å™„Åü„Äç„ÅÆÈè°„Åß„Åô„ÄÇË°åÂãï„ÇÑÁµåÈ®ì„ÅßÂ§â„Çè„Å£„Å¶„ÅÑ„Åç„Åæ„Åô„ÄÇÂæå„ÅßÊàª„Å£„Å¶„Åç„Å¶„ÇÇÂ§ß‰∏àÂ§´„ÄÇ';
            article.appendChild(gentle);

            // ‚ë£ Fineme„ÅåÁ¥ÑÊùü„Åô„Çã„Åì„Å®
            const promh = document.createElement('h3'); promh.textContent='Fineme„ÅØ„ÄÅ„ÅÇ„Å™„Åü„Çí„Åì„ÅÜÊâ±„ÅÑ„Åæ„Åô'; article.appendChild(promh);
            const ul = document.createElement('ul');
            ['ÁÑ°ÁêÜ„Å´ÊµÅË°å„ÇíÊäº„Åó„Å§„Åë„Åæ„Åõ„Çì','‰æ°Ê†º„Çà„Çä‚ÄúÁõ∏ÊÄß‚Äù„ÇíÂÑ™ÂÖà„Åó„Åæ„Åô','„ÅÇ„Å™„Åü„ÅÆ„Éö„Éº„Çπ„ÇíÂ∞äÈáç„Åó„Åæ„Åô'].forEach(t=>{ const li = document.createElement('li'); li.textContent = t; ul.appendChild(li); });
            article.appendChild(ul);

            // ‚ë§ ‰∏¶„Å≥È†Ü„ÅÆË¶ãÊñπÔºàÁõ∏ÊÄßÈ†Ü„ÅÆÊÑèÂë≥„Å•„ÅëÔºâ
            const readh = document.createElement('h3'); readh.textContent='‰∏¶„Å≥È†Ü„ÅÆË¶ãÊñπ'; article.appendChild(readh);
            const readp = document.createElement('p'); readp.textContent = '‰∏ä„ÅÆÂ∫óËàó„Åª„Å©„ÄÅ„ÅÇ„Å™„Åü„ÅÆ„ÄåÈÅ∏„Å≥Êñπ„Äç„Å´Ëøë„ÅÑÂÇæÂêë„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ‰æ°Ê†º„Åß„ÅØ„Å™„Åè„ÄåÁ¥çÂæó„ÅÆ„Åó„ÇÑ„Åô„Åï„Äç„ÄåÂØÑ„ÇäÊ∑ª„ÅÑ„Äç„ÄåÊúÄÁü≠„ÅßÈÄ≤„ÇÅ„ÇãÂäõ„Äç„Äå‰∏ñÁïåË¶≥„ÅÆÂêàËá¥„Äç„Å®„ÅÑ„Å£„ÅüËª∏„ÇíÂÑ™ÂÖà„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ'; article.appendChild(readp);

            // ‚ë• Ê¨°„ÅÆ‰∏ÄÊ≠©
            const actions = document.createElement('div'); actions.className = 'result-actions';
            const seeBtn = document.createElement('a'); seeBtn.href = '/pages/search.html?diag=1'; seeBtn.className = 'btn'; seeBtn.textContent = '„Åì„ÅÆ„Çø„Ç§„Éó„Å´Âêà„ÅÜ‰∫∫„ÇíË¶ã„Å¶„Åø„Çã';
            const retryLink = document.createElement('a'); retryLink.href = '/diagnosis/index.html'; retryLink.className = 'btn'; retryLink.textContent = 'Ë®∫Êñ≠„Çí„ÇÑ„ÇäÁõ¥„Åô';
            const saveBtn = document.createElement('button'); saveBtn.className = 'btn btn-ghost'; saveBtn.textContent = 'ÁµêÊûú„Çí„Ç≥„Éî„Éº';
            saveBtn.addEventListener('click', ()=>{
              const text = `${entry.name}\n${entry.catch||''}\n\n${entry.advice||''}`; try{ navigator.clipboard.writeText(text); showToast('ÁµêÊûú„Çí„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü'); }catch(e){ showToast('„Ç≥„Éî„Éº„Å´Â§±Êïó„Åó„Åæ„Åó„Åü'); }
            });
            actions.appendChild(seeBtn); actions.appendChild(retryLink); actions.appendChild(saveBtn); article.appendChild(actions);

            root.appendChild(article);

              // Optional: providerId„Åå„ÇØ„Ç®„É™„Å´„ÅÇ„ÇãÂ†¥Âêà„ÄÅÂ∫óËàó„Éó„É≠„Éï„Ç£„Éº„É´√óË®∫Êñ≠„ÅßÁõ∏ÊÄßË™¨ÊòéÊñá„ÇíÁîüÊàê„Åó„Å¶Ë°®Á§∫
              try{
                const u = new URL(location.href);
                const providerId = u.searchParams.get('providerId') || '';
                if(providerId){
                  (async function(){
                    async function loadProviders(){
                      try{ const raw = localStorage.getItem('glowup:providers'); const arr = raw? JSON.parse(raw):[]; return Array.isArray(arr)? arr:[]; }catch{ return []; }
                    }
                    async function loadStaticProviders(){
                      try{ const r = await fetch('/scripts/data/providers.json', { cache:'no-store' }); if(!r.ok) throw new Error(String(r.status)); const j = await r.json(); return Array.isArray(j)? j:[]; }catch(e){ return []; }
                    }
                    const mod = await import('/scripts/compatibility.js');
                    let providers = await loadProviders();
                    if(!providers.length){ providers = await loadStaticProviders(); }
                    const provider = providers.find(p=> p.id === providerId);
                    if(provider){
                      const comp = await mod.generateCompatibility(obj, provider);
                      if(comp){
                        const host = document.createElement('div'); host.className = 'diag-card'; host.style.marginTop = '14px';
                        const head = document.createElement('div'); head.className='stack';
                        const strong = document.createElement('strong'); strong.textContent = '„ÅÇ„Å™„Åü„Å®„ÅÆÁõ∏ÊÄßË™¨ÊòéÔºàÂ∫óËàóÂà•Ôºâ'; head.appendChild(strong);
                        host.appendChild(head);
                        mod.renderCompatibilityCard(host, comp);
                        root.appendChild(host);
                      }
                    }
                  })();
                }
              }catch(e){ /* optional */ }

            // toast element
            const toast = document.createElement('div'); toast.className = 'toast'; toast.id = 'result-toast'; toast.textContent = '';
            document.body.appendChild(toast);
            function showToast(msg){ const t = document.getElementById('result-toast'); t.textContent = msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),2000); }
          }).catch(e=>{ console.error(e); loading.textContent = '„Çø„Ç§„Éó„Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü'; });
        }catch(e){ console.error(e); renderNotFound(); }
      }

  retryBtn.addEventListener('click', ()=>{ window.location.href = '/diagnosis/index.html'; });
    })();
  </script>
</body>
</html>
