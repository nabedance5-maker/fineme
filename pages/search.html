<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>検索結果 | Fineme</title>
  <link rel="stylesheet" href="../assets/styles/style.css" />
  <link rel="stylesheet" href="../assets/styles/components.css" />
</head>
<body>
  <header id="site-header"></header>
  <main class="section">
    <div class="container stack">
      <h1 class="section-title">検索結果</h1>
      <form class="searchbar" action="./search.html" method="get">
        <input name="keyword" placeholder="何を探しますか？（例：メンズメイク、第一印象、撮影）" />
        <select name="region">
          <option value="">全国</option>
          <option value="hokkaido">北海道</option>
          <option value="aomori">青森県</option>
          <option value="iwate">岩手県</option>
          <option value="miyagi">宮城県</option>
          <option value="akita">秋田県</option>
          <option value="yamagata">山形県</option>
          <option value="fukushima">福島県</option>
          <option value="ibaraki">茨城県</option>
          <option value="tochigi">栃木県</option>
          <option value="gunma">群馬県</option>
          <option value="saitama">埼玉県</option>
          <option value="chiba">千葉県</option>
          <option value="tokyo">東京都</option>
          <option value="kanagawa">神奈川県</option>
          <option value="niigata">新潟県</option>
          <option value="toyama">富山県</option>
          <option value="ishikawa">石川県</option>
          <option value="fukui">福井県</option>
          <option value="yamanashi">山梨県</option>
          <option value="nagano">長野県</option>
          <option value="gifu">岐阜県</option>
          <option value="shizuoka">静岡県</option>
          <option value="aichi">愛知県</option>
          <option value="mie">三重県</option>
          <option value="shiga">滋賀県</option>
          <option value="kyoto">京都府</option>
          <option value="osaka">大阪府</option>
          <option value="hyogo">兵庫県</option>
          <option value="nara">奈良県</option>
          <option value="wakayama">和歌山県</option>
          <option value="tottori">鳥取県</option>
          <option value="shimane">島根県</option>
          <option value="okayama">岡山県</option>
          <option value="hiroshima">広島県</option>
          <option value="yamaguchi">山口県</option>
          <option value="tokushima">徳島県</option>
          <option value="kagawa">香川県</option>
          <option value="ehime">愛媛県</option>
          <option value="kochi">高知県</option>
          <option value="fukuoka">福岡県</option>
          <option value="saga">佐賀県</option>
          <option value="nagasaki">長崎県</option>
          <option value="kumamoto">熊本県</option>
          <option value="oita">大分県</option>
          <option value="miyazaki">宮崎県</option>
          <option value="kagoshima">鹿児島県</option>
          <option value="okinawa">沖縄県</option>
        </select>
        <select name="purpose" title="検索の目的を選択">
          <option value="">目的で絞り込む（任意）</option>
          <option value="first_impression">第一印象を変えたい</option>
          <option value="profile_photo">プロフィール写真を良くしたい</option>
          <option value="confidence">恋愛で自信を持ちたい</option>
          <option value="body_shape">体を整えたい</option>
          <option value="know_what_suits">自分に似合うものを知りたい</option>
          <option value="total_update">トータルで磨く</option>
        </select>
        <select name="category">
          <option value="">すべてのカテゴリ</option>
          <option value="consulting">外見トータルサポート</option>
          <option value="gym">パーソナルジム</option>
          <option value="makeup">メイクアップ</option>
          <option value="hair">ヘア</option>
          <option value="diagnosis">カラー/骨格診断</option>
          <option value="fashion">コーデ提案</option>
          <option value="photo">写真撮影（アプリ等）</option>
          <option value="marriage">結婚相談所</option>
          <option value="eyebrow">眉毛</option>
          <option value="hairremoval">脱毛</option>
          <option value="esthetic">エステ</option>
          <option value="whitening">ホワイトニング</option>
          <option value="orthodontics">歯科矯正</option>
          <option value="nail">ネイル</option>
        </select>
        <select name="sort" aria-label="並べ替え">
          <option value="">おすすめ順</option>
          <option value="price_asc">料金が安い順</option>
          <option value="price_desc">料金が高い順</option>
          <option value="name_asc">名前（50音順）</option>
          <option value="name_desc">名前（逆順）</option>
        </select>
        <select name="per" aria-label="1ページあたりの件数">
          <option value="12">12件/ページ</option>
          <option value="24">24件/ページ</option>
          <option value="48">48件/ページ</option>
        </select>
        <button class="btn" type="submit">検索</button>
      </form>
      <div class="results-meta">
        <p id="results-count" class="muted"></p>
        <p id="results-range" class="muted"></p>
      </div>
      <div id="results" class="features-grid"></div>
    </div>
  </main>
  <footer id="site-footer"></footer>
  <script src="../scripts/main.js" type="module"></script>
  <script src="../scripts/search.new.js" type="module"></script>
  <script type="module">
    // Reflect current query into the form (supports ?q or ?keyword)
    const u = new URL(location.href);
    const q = u.searchParams.get('q') || u.searchParams.get('keyword') || '';
    const region = u.searchParams.get('region') || '';
    const category = u.searchParams.get('category') || '';
  const purpose = u.searchParams.get('purpose') || '';
    const sort = u.searchParams.get('sort') || '';
    const per = u.searchParams.get('per') || '12';
    const form = document.querySelector('form.searchbar');
    if(form){
      const kw = form.querySelector('input[name="keyword"]'); if(kw) kw.value = q;
      const rg = form.querySelector('select[name="region"]'); if(rg) rg.value = region;
      const ct = form.querySelector('select[name="category"]'); if(ct) ct.value = category;
  const pu = form.querySelector('select[name="purpose"]'); if(pu) pu.value = purpose;
      const st = form.querySelector('select[name="sort"]'); if(st) st.value = sort;
      const ps = form.querySelector('select[name="per"]'); if(ps) ps.value = per;
      // ソート変更時に即時検索
      const sortSel = form.querySelector('select[name="sort"]');
      if(sortSel){
        sortSel.addEventListener('change', () => {
          form.requestSubmit ? form.requestSubmit() : form.submit();
        });
      }
      const perSel = form.querySelector('select[name="per"]');
      if(perSel){
        perSel.addEventListener('change', () => {
          // ページ数を戻す
          if(!form.action.includes('?')){
            // noop
          }
          form.requestSubmit ? form.requestSubmit() : form.submit();
        });
      }
    }
  </script>
</body>
</html>
